# Week 1 Day 3: secp256k1 参数详解

**日期：** 2026-02-04  
**主题：** secp256k1 曲线参数及设计原理

---

## 一、secp256k1 是什么？

**SEC**（Standards for Efficient Cryptography）定义的一条椭圆曲线。

```
sec   = Standards for Efficient Cryptography
p     = 素数域（prime field）
256   = 256 位
k     = Koblitz 曲线（特殊结构，计算更快）
1     = 该类型的第 1 条曲线
```

**谁在用？**
- Bitcoin
- Ethereum
- 大部分区块链

---

## 二、完整参数

### 2.1 曲线方程

```
y² = x³ + ax + b

其中:
a = 0
b = 7

所以: y² = x³ + 7
```

### 2.2 素数 p（有限域大小）

```
p = 0xFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 
      FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F

十进制:
p = 115792089237316195423570985008687907853269984665640564039457584007908834671663

特殊形式:
p = 2²⁵⁶ - 2³² - 977
p = 2²⁵⁶ - 2³² - 2⁹ - 2⁸ - 2⁷ - 2⁶ - 2⁴ - 1
```

### 2.3 生成元 G

```
Gx = 0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798

Gy = 0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8
```

### 2.4 阶 n（G 的循环周期）

```
n = 0xFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE 
      BAAEDCE6 AF48A03B BFD25E8C D0364141

十进制:
n = 115792089237316195423570985008687907852837564279074904382605163141518161494337

含义: n × G = O（无穷远点）
```

### 2.5 余因子 h

```
h = 1

含义: 曲线上的点数 = n × h = n
所有点都在以 G 为生成元的子群里
```

---

## 三、为什么选择这些参数？

### 3.1 为什么 p = 2²⁵⁶ - 2³² - 977？

**原因 1：接近 2 的幂，模运算超快**

```
计算 x mod p:

设 x = x_high × 2²⁵⁶ + x_low  (x 是 512 位数)

因为 2²⁵⁶ ≡ 2³² + 977 (mod p)

所以:
x mod p ≡ x_low + x_high × (2³² + 977) (mod p)

只需要乘法和加法，不需要除法！
```

**原因 2：p 是素数**（必须是素数才能构成有限域）

### 3.2 为什么 a = 0？

**计算效率！**

```
原公式: λ = (3x² + a) / (2y)
简化为: λ = 3x² / (2y)

省掉一次加法
```

### 3.3 为什么 b = 7？

曲线必须满足：4a³ + 27b² ≠ 0（确保曲线光滑）

当 a = 0 时，b = 7 是满足安全要求的最小值之一。

### 3.4 为什么 n ≈ p？

```
n ≈ p 意味着 h = 1

好处：
- 所有点都有用（没有"弱"子群）
- 避免 small subgroup attack
- 私钥空间最大化（≈ 2²⁵⁶）
```

---

## 四、Koblitz 曲线的特点

### 4.1 定义

```
Koblitz 曲线: a ∈ {0, -3}, b 是小整数

secp256k1: a = 0, b = 7  ✓
```

### 4.2 优势

```
1. 计算更快
   - a = 0 省掉乘法
   - 特殊结构可用 GLV 优化（标量乘法快 30-50%）

2. 参数简单透明
   - 没有"神秘数字"
   - 不可能有后门
```

### 4.3 GLV 优化

利用曲线的自同态加速标量乘法：

```
普通: kG = G + G + ... + G  (k 次)

GLV:  kG = k₁G + k₂λG
      其中 k₁, k₂ 都是 128 位（原来 k 是 256 位）
      λ 是曲线的自同态映射

效率提升约 40%！
```

---

## 五、与 secp256r1 (P-256) 对比

| | secp256k1 | secp256r1 (P-256) |
|---|-----------|-------------------|
| a | 0 | -3 |
| b | 7 | 一个很长的"随机"数 |
| 来源 | 数学推导 | NIST 指定（NSA 参与） |
| 后门风险 | 极低 | 存疑（参数来源不明） |
| 谁在用 | Bitcoin, Ethereum | 政府、银行、TLS |

### secp256r1 的争议

```
secp256r1 的 b 参数:
b = 0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B

官方说法: SHA-1("某个种子")
问题: 种子是什么？为什么选这个种子？
怀疑: NSA 可能选了一个对他们有利的参数
```

### 比特币为什么选 secp256k1？

1. **透明性** - 参数来源清晰，没有神秘数字
2. **效率** - Koblitz 曲线计算更快
3. **抗审查** - 不依赖政府标准，降低后门风险

---

## 六、安全性分析

### 6.1 私钥空间

```
私钥范围: [1, n-1]
n ≈ 2²⁵⁶ ≈ 10⁷⁷

暴力破解需要尝试 2²⁵⁶ 次
即使全世界所有电脑一起算，宇宙毁灭也算不完
```

### 6.2 已知攻击

| 攻击 | 复杂度 | 威胁 |
|------|--------|------|
| 暴力破解 | 2²⁵⁶ | ❌ 不可能 |
| Pollard's rho | 2¹²⁸ | ❌ 不可能 |
| 量子计算 (Shor) | 多项式 | ⚠️ 未来威胁 |

### 6.3 量子威胁

```
经典计算机: ECDLP 是困难问题
量子计算机: Shor 算法可以高效解决

时间线预估:
- 2030-2040 可能出现威胁级量子计算机
- 届时需要迁移到后量子密码学
```

---

## 七、总结

| 参数 | 值 | 为什么 |
|------|-----|--------|
| p | 2²⁵⁶ - 2³² - 977 | 快速模运算 |
| a | 0 | 简化计算 |
| b | 7 | 最小安全值 |
| G | (Gx, Gy) | 固定生成元 |
| n | ≈ 2²⁵⁶ | 私钥空间≈曲线点数 |
| h | 1 | 无弱子群 |

**核心设计理念**：
- 简单透明（无神秘数字）
- 计算高效（Koblitz 结构）
- 足够安全（256 位）

---

## 参考资料

- [SEC 2: Recommended Elliptic Curve Domain Parameters](https://www.secg.org/sec2-v2.pdf)
- [Bitcoin Wiki - Secp256k1](https://en.bitcoin.it/wiki/Secp256k1)
